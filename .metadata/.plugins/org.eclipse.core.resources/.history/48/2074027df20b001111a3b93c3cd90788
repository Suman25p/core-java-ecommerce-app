package com.ecommerce.main;

import java.util.List;
import java.util.Scanner;

import com.ecommerce.exception.OutOfStockException;
import com.ecommerce.exception.ProductNotAvailableException;
import com.ecommerce.model.Products;
import com.ecommerce.service.CartManagement;
import com.ecommerce.service.CheckoutProcess;
import com.ecommerce.service.ProductManagement;

public class MainDriver {
	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
	
		ProductManagement productManagement = new ProductManagement();
		CartManagement cartManagement = new CartManagement();
		CheckoutProcess checkoutProcess = new CheckoutProcess();
		
		productManagement.addAllProducts();
		
		while(true) {
			System.out.println("===== +++  WELCOME ! +++ ===== ");
			System.out.println("1. View Products");
			System.out.println("2. Search Product");
			System.out.println("3. Sort By Price in Assending");
			System.out.println("4. Sort By Price in Descending");
			System.out.println("5. Add to Cart");
			System.out.println("6. Remove from Cart");
			System.out.println("7. View Cart");
			System.out.println("8. Checkout");
			System.out.println("9. Exit");
			
			int selectPreference = sc.nextInt();
			
			try {
				switch(selectPreference)
				{
				case 1: 
					productManagement.displayProducts();
					break;
				
				case 2:
					
				    System.out.println("Enter product name: ");
				    String name = sc.next();

				    try {
				        List<Products> results =
				                productManagement.searchByName(name);

				        results.forEach(System.out::println);

				    } catch (ProductNotAvailableException e) {
				        System.out.println(e.getMessage());
				    }

				    break;
	
				case 3:
					productManagement.sortPriceAsc();
					break;
					
				case 4:
					productManagement.sortPriceDesc();
					break;
					
				case 5:
					System.out.println("Enter Product Id : ");
					int id = sc.nextInt();
					System.out.println("Enter quantity: " );
					int qty = sc.nextInt();
					
					Products product = productManagement.getProductById(id);
					
					try {
						cartManagement.addToCart(product, qty);
						System.out.println("Added to cart!");
					} catch(OutOfStockException e) {
						System.out.println(e.getMessage());
					}
					break;
				case 6:
					 System.out.println("Enter product ID to remove: ");
					    int removeId = sc.nextInt();

					    try {
					        cartManagement.removeFromCart(product, removeId);
					    } catch (ProductNotAvailableException e) {
					        System.out.println(e.getMessage());
					    }

					    break;
				case 7:
					cartManagement.viewCart();
					break;
					
				case 8:
					try {
						checkoutProcess.checkOut(cartManagement.getCart());
					}catch(OutOfStockException e) {
						System.out.println(e.getMessage());
					}
					
					break;
					
				case 9: 
					System.out.println("Thank you for shopping!");
					return;
				}
			} catch (Exception e) {
				
				e.printStackTrace();
			}
		} 
	}
}
