package com.ecommerce.service;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;
import java.util.stream.Collectors;

import com.ecommerce.exception.ProductNotAvailableException;
import com.ecommerce.model.Products;

public class ProductManagement {
	
	private List<Products > productsList = new ArrayList<>();
	
	public void addAllProducts() {
		productsList.addAll(Arrays.asList(
				new Products(1, "Laptop", 50000, 5),
				new Products(2, "Mobile", 26000, 10),
				new Products(2, "Mobile", 27000, 5),
				new Products(3, "HeadPhones", 2000, 15),
				new Products(4, "Keyboard", 1500, 20),
				new Products(5, "Mouse", 800, 25),
				new Products(6, "Monitor", 12000, 8),
				new Products(7, "Printer", 9000, 2),
				new Products(8, "Tablet", 18000, 5),
				new Products(9, "SmartWatch", 7000, 5),
				new Products(10, "Speaker", 3000, 1),
				new Products(11, "Speaker", 2500, 2),
				new Products(12, "SmartWatch", 7000, 5)
				));
	}
	
	
	public void displayProducts() throws ProductNotAvailableException
	{	
		try {
			if(productsList.isEmpty()) 
				throw new ProductNotAvailableException("No Products Available");
			
		}
		finally {
			
			Iterator<Products> iterator = productsList.iterator();
				
			while(iterator.hasNext()) {
				System.out.println(iterator.next());
			}
		}
	}
	
	
	public List<Products> searchByName(String name) throws ProductNotAvailableException {
		
		String lowercase = name.toLowerCase();
		
		List<Products> output =  productsList.stream()
				.filter(n -> n.getName()
				.toLowerCase()
				.contains(lowercase))
				.map(Products:: getName)
				.collect(Collectors.toList());
		
		if(output.isEmpty())
		{
			throw new ProductNotAvailableException("Product is not available" + name);
		}
		return output;
	}
	
	// price in Ascending
	public void sortPriceAsc()
	{
		List<Products> result = productsList.stream().sorted(Comparator.comparing(Products:: getPrice)).toList();
		System.out.println(result);
	}
	
	//Price in Descending
	public void sortPriceDesc() {
		List<Products> result = productsList.stream().sorted(Comparator.comparing(Products:: getPrice).reversed()).toList();
		System.out.println(result);
	}
	
	
	public Products getProductById(int id)
	{
		return productsList.stream()
				.filter(p -> p.getId() == id)
				.findFirst()
				.orElseThrow();
	}
	
}
