package com.ecommerce.service;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;
import java.util.stream.Collectors;

import com.ecommerce.exception.ProductNotAvailableException;
import com.ecommerce.model.Product;

public class ProductManagement {
	private List<Product > productList = new ArrayList<>();
	
	//Loading sample products
	public void addAllProducts() {
		productList.addAll(Arrays.asList(
				new Product(1, "Laptop", 50000, 5),
				new Product(2, "Mobile", 26000, 10),
				new Product(2, "Mobile", 27000, 5),
				new Product(3, "HeadPhones", 2000, 15),
				new Product(4, "Keyboard", 1500, 20),
				new Product(5, "Mouse", 800, 25),
				new Product(6, "Monitor", 12000, 8),
				new Product(7, "Printer", 9000, 2),
				new Product(8, "Tablet", 18000, 5),
				new Product(9, "SmartWatch", 7000, 5),
				new Product(10, "Speaker", 3000, 1),
				new Product(11, "Speaker", 2500, 2),
				new Product(12, "SmartWatch", 7000, 5)
				));
	}
	
	//display all products
	public void displayProducts() throws ProductNotAvailableException
	{	
		try {
			if(productList.isEmpty()) 
				throw new ProductNotAvailableException("No Products Available");
			
		}
		finally {
			
			Iterator<Product> iterator = productList.iterator();
				
			while(iterator.hasNext()) {
				System.out.println(iterator.next());
			}
		}
	}
	
	//Search product name using Stream API
	public List<Product> searchByName(String name) throws ProductNotAvailableException {
		
		String lowercase = name.toLowerCase();
		
		List<Product> output =  productList.stream()
				.filter(n -> n.getName()
				.toLowerCase()
				.contains(lowercase))
				.collect(Collectors.toList());
		
		if(output.isEmpty())
		{
			throw new ProductNotAvailableException("Product is not available" + name);
		}
		return output;
	}
	
	//Sorting price in Ascending
	public void sortPriceAsc()
	{
		List<Product> result = productList.stream().sorted(Comparator.comparing(Product:: getPrice)).toList();
		System.out.println(result);
	}
	
	//Sorting Price in Descending
	public void sortPriceDesc() {
		List<Product> result = productList.stream().sorted(Comparator.comparing(Product:: getPrice).reversed()).toList();
		System.out.println(result);
	}
	
	//Get product by Id
	public Product getProductById(int id)
	{
		return productList.stream()
				.filter(p -> p.getId() == id)
				.findFirst()
				.orElse(null);
	}
	
}
